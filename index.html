<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Version Control - Code </title>
		<link rel="shortcut icon" href="pics/faviconit/favicon-310-tp.png"  type="image/x-icon">
		<link rel="stylesheet" href="css/slides.css">
		<link rel="stylesheet" href="css/reset.css">
		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/white.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/monokai.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<!-- nested sections for vertical slides -->
					<section data-background-image="pics/dsu_course_homepage11.png">
						<aside class="notes">
							先前課程中，介紹如何使用 git 對專案文檔進行管控。<br>
							面對不同使用情境，透過指令快速進行應對，達到專案運行上的彈性操作<br>
						</aside>
					</section>
					<section >
						<h2>Transition Styles</h2>
						<p>
							You can select from different transitions, like:<br>
							<a href="?transition=none#/transitions">None</a> -
							<a href="?transition=fade#/transitions">Fade</a> -
							<a href="?transition=slide#/transitions">Slide</a> -
							<a href="?transition=convex#/transitions">Convex</a> -
							<a href="?transition=concave#/transitions">Concave</a> -
							<a href="?transition=zoom#/transitions">Zoom</a>
						</p>
						<aside class="notes">
							Oh hey, these are some notes. They'll be hidden in your presentation, but you can see them if you open the speaker notes window (hit 's' on your keyboard).
						</aside>
					</section>
					<section id="themes">
						<h2>Themes</h2>
						<p>
							reveal.js comes with a few themes built in:<br>
							<!-- Hacks to swap themes after the page has loaded. Not flexible and only intended for the reveal.js demo deck. -->
							<a href="#" onclick="document.getElementById('theme').setAttribute('href','css/theme/black.css'); return false;">Black (default)</a> -
							<a href="#" onclick="document.getElementById('theme').setAttribute('href','css/theme/white.css'); return false;">White</a> -
							<a href="#" onclick="document.getElementById('theme').setAttribute('href','css/theme/league.css'); return false;">League</a> -
							<a href="#" onclick="document.getElementById('theme').setAttribute('href','css/theme/sky.css'); return false;">Sky</a> -
							<a href="#" onclick="document.getElementById('theme').setAttribute('href','css/theme/beige.css'); return false;">Beige</a> -
							<a href="#" onclick="document.getElementById('theme').setAttribute('href','css/theme/simple.css'); return false;">Simple</a><br>
							<a href="#" onclick="document.getElementById('theme').setAttribute('href','css/theme/serif.css'); return false;">Serif</a> -
							<a href="#" onclick="document.getElementById('theme').setAttribute('href','css/theme/blood.css'); return false;">Blood</a> -
							<a href="#" onclick="document.getElementById('theme').setAttribute('href','css/theme/night.css'); return false;">Night</a> -
							<a href="#" onclick="document.getElementById('theme').setAttribute('href','css/theme/moon.css'); return false;">Moon</a> -
							<a href="#" onclick="document.getElementById('theme').setAttribute('href','css/theme/solarized.css'); return false;">Solarized</a>
						</p>
					</section>
					<section data-background-video="https://s3.amazonaws.com/static.slid.es/site/homepage/v1/homepage-video-editor.mp4,https://s3.amazonaws.com/static.slid.es/site/homepage/v1/homepage-video-editor.webm" data-background-color="#000000">
						<div style="background-color: rgba(0, 0, 0, 0.9); color: #fff; padding: 20px;">
							<h2>Video Backgrounds</h2>
							<pre><code class="hljs html" style="word-wrap: break-word;">&lt;section data-background-video="video.mp4,video.webm"&gt;</code></pre>
						</div>
					</section>
				</section>

				<section data-background-image="pics/dsu_course_background.png" data-markdown data-separator=">>>>" data-separator-vertical="vvvv">
					<script type="text/template">
						# Disadvantage of Git
						* Steep learning curve
						* Less support for binaries
						* Poor support for large files
						<aside class="notes">
							之前提了不少GIT的優點，今天要平衡報導，說些 GIT 比較弱的地方:<br>
							入門具有一定難度 (初次接觸者，前一堂課應該有體會)<br>
							文字檔以外的類型支援度不太好 (文檔比對之相關功能都無法使用)<br>
							大型檔案處理效率低落(今天重點)
						</aside>
						>>>>

						## Difficulty handling large files in Git
						實際運行時效率的低落<br>
						<img src="https://www.ciandt.com.cn/sites/default/files/Image_Aticle_D_8.jpg" width="600px"/>
						<aside class="notes">
							多數人使用 git 是為了在 remote server 進行集中管理<br>
							大多 git service 建議:單檔<100MB、單一repository<1GB <br>
							傳統作法，使用 Git-LFS，<br>
							還是有些問題需要克服，整理成以下比較表
						</aside>
						vvvv

						## Comparison between DVC and git-lfs
						|            | DVC                       | Git-LFS                            |
						| ---------- | -------------------------------- | ------------------------------ |
						| 單檔限制     | unlimited               ✔  | mostly, < 2GB              |
						| 儲存空間   | self-host\cloud services ✔        | 僅支援部分 git service 提供商   |
						| 建置成本     |  可用 cloud services，成本較低✔        | 一定要架設 LFS-server    |
						| I\O 效率   | cloud services 速度普遍較快✔               | 取決於 git service 提供商頻寬限制 |
						| Reproducibility | code&data&model&config <br>關聯緊密✔   | 僅 code&data 版本對應       |

						<p class="fragment">
							> DVC 94狂~
						</p>
						<aside class="notes">
							左邊 DVC 是今天要介紹的主題，右邊 GIT_LFS 則是過去常見的 solution<br>
							DVC 支援 cloud services，儲存空間&頻寬有保障<br>
							LFS 必須自架 data server & 僅部分 git 服務提供商有支援<br>
							DVC 對於檔案間的關聯機制，有利於 data science 專案運行<br>
							可以視為 GIT_LFS 的進階版
						</aside>
					</script>
				</section>

				<section data-background-image="pics/dsu_course_background.png" data-markdown data-separator=">>>>" data-separator-vertical="vvvv">
					<script type="text/template">
						## DVC - Data Version Control
						Version Control System for Machine Learning Projects<br><br><br>
						<img src="https://camo.githubusercontent.com/5a255b6d3eb61f712a6358e604206fff9f073671/68747470733a2f2f6476632e6f72672f696d672f6c6f676f2d6769746875622d726561646d652e706e67" width="900px"/>
						<aside class="notes">
							基本介紹<br>
							DVC 是為了讓 data science workflow 更加 “工程化” 而誕生的一種版控機制<br>
							致力於減少實驗重現時各種可能的干擾變因，<br>
							透過 程式&資料同步進行管控\關聯，達到此目的
						</aside>
						vvvv

						## DVC - Data Version Control
						### When to use
						* 程式碼\文件與大型檔案之間有強烈相依性
						* 大型檔案也具有版本管控需求

						<p class="fragment">
							> 輪到 DVC 上場 ~
						</p>
						<aside class="notes">
							主要還是針對程式碼，需要讀取相關檔案才能運行的使用情境<br>
							而不同版本的程式又對應到不同版本的檔案<br>
							而這些檔案又異常的占空間
						</aside>
						vvvv

						## DVC - Data Version Control
						### Features
						* Integration with Git<br>
						<img src="https://i.iter01.com/images/52ce4c4f62c3483ca0921ec643d0f7c698974d55927dbc75e5f4b0668f02b58d.jpg" width="500px"/>

						<aside class="notes">
							關於 DVC 的基本特色:<br>
							DVC 的資料儲可存放在許多儲存系統上，local\remote<br>
							與 GIT 高度整合，指令與 Git 類似(push\pull\add\checkout ...)<br>
							簡言之，git 管控程式；DVC 管控檔案
						</aside>
						vvvv

						## DVC - Data Version Control
						### Features
						* Connect Data&Model with Code<br>
						<img src="https://i.iter01.com/images/f27303ec50dc628c36ed84142819a26f34771f175ceb8250d4f7d29f0b88e857.jpg" width="500px"/>

						<aside class="notes">
							DVC 產出的 .dvc 檔案描述了 使用的資料 & 要執行的程式 ...等相關資訊<br>
							而 git 僅對於 .dvc 檔案進行版控<br>
							隨著 git 切換程式碼版本 .dvc 檔也同步進行切換<br>
							如此，便達成了 CODE & DATA\MODEL 同步的機制
						</aside>
					</script>
				</section>

				<section data-markdown data-background="https://media.giphy.com/media/Ln2dAW9oycjgmTpjX9/giphy.gif">
					<script type="text/template">
						<aside class="notes">
							接下來進行手把手操作教學
						</aside>
					</script>
				</section>

				<section data-background-image="pics/dsu_course_background.png" data-markdown data-separator=">>>>" data-separator-vertical="vvvv">
					<script type="text/template">
					## Installation
					* 以 python pip 進行安裝 <br>
							pip install dvc
					* 安裝對應的 remote storage 套件：
							pip install "dvc[gs]"
					<aside class="notes">
						不同 remote storage 需搭配對應的套件才能運行 (以 GCP cloud storage 為例)
					</aside>
					vvvv

					## Installation
					![](https://res.cloudinary.com/practicaldev/image/fetch/s--zeeExErY--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/1to9uwdybq35pfgbt7rq.png)
					<aside class="notes">
						因為本次 DEMO 以 python 進行，故直接使用 python 套件管理工具進行安裝
					</aside>
					vvvv

					## Installation
					### Official Installation Instruction
					* [Windows](https://dvc.org/doc/install/windows)
					* [Linux](https://dvc.org/doc/install/linux)
					* [MacOS](https://dvc.org/doc/install/macos)
					<aside class="notes">
						連結包含詳細各系統\不同工具的安裝說明，請自行參閱
					</aside>
					vvvv

					## Installation
					在 CLI 畫面下，輸入 `dvc`<br>
					<img src="https://i.imgur.com/g5dhvK6.png" width="400px"/>
					<aside class="notes">
						安裝完畢後。出現以下內容，即為安裝成功
					</aside>
					</script>
				</section>

				<section data-background-image="pics/dsu_course_background.png" data-markdown data-separator=">>>>" data-separator-vertical="vvvv">
					<script type="text/template">
					## Basic commands
					指令操作細節，可透過以下方式查詢
					* `dvc XXX -h`
					* `dvc XXX --help`

					<p class="fragment">
						> 與 git 使用方式一致
					</p>
					<aside class="notes">
						是否有種似曾相識的感覺?<br>
						接下來介紹，最基本的常用指令
					</aside>
					vvvv

					### Initialization
					* Git<br>
							git init
					請參閱 [Git for Rookies](https://hackmd.io/8-JO3RZHToquN3w2w10cMg?view#Environment-setup)

					* DVC<br>
							dvc init
					<aside class="notes">
						若對於 git 還不熟悉，建議先看前一堂課程<br>
						否則接下來的內容會讓你一頭霧水
					</aside>
					vvvv

					### Initialization
					<img src="https://i.imgur.com/tvVDjsw.gif"/>
					<aside class="notes">
						初始化完成，會看到以下畫面<br>
						目錄底下多一個 .dvc/ 資料夾，看一下多了那些檔案
					</aside>
					vvvv

					### Initialization
					* DVC<br>
					初始化資料夾之結構大致如下：
					```
					dvc-test
					├── .git/
					├── .dvc/
					│   ├── .gitignore
					│   ├── cache/
					│   └── config
					├── main.py
					└── .gitignore
					```

					<aside class="notes">
						`.dvc/.gitignore` : 過濾一些管控權限由 Git 移轉至 DVC 之檔案<br>
						`.dvc/cache/` : DVC 會在這邊建立檔案的連結，存放 push\pull 的檔案<br>
						`.dvc/config` : 和 .git/config 功能相同，存一些 user 的基本設定<br>
						進入基本操作教學
					</aside>
					>>>>

					### DVC Basics
					#### Step1: 將需要版控的檔案納入 DVC 管控中<br>
					`dvc add <file_name \ directory>`

					#### Step2: 將程式碼及 DVC 相關檔案納入 Git 版控機制<br>
					`git add \ commit`

					<aside class="notes">
						首先介紹最基本的 DVC 使用方式<br>
						dvc add 將檔案納入DVC管控<br>
						最後，透過 git 將 DVC 產出的檔案進版
					</aside>
					vvvv

					### DVC Basics
					<img src="https://i.imgur.com/qUnGuRA.gif"/>

					<aside class="notes">
						dvc add 將檔案納入 DVC 版控之中<br>
						檔案經過編碼後，存放至 .dvc/cache/ 目錄下<br>
						接著，將輸出的 .dvc 檔案透過 git add\commit 納入版控之中即可
					</aside>
					vvvv

					### DVC Basics
					#### Step3: 推送檔案至遠端存放區 (Git repository)<br>
					1. 先添加 SSH key 至 Git service 之 account	<br>
					詳細請參閱[前一堂課程](https://hackmd.io/8-JO3RZHToquN3w2w10cMg?view#%E5%90%8C%E6%AD%A5)<br><br>
					2. `git remote add <remote_name> <remote_url>`
					3. `git push <remote_name>`
					<aside class="notes">
						再來，將 CODE 先推送至 REMOTE<br>
						push 時會需要 KEY 進行認證，細節請參考...<br>
						最後，記得 DVC 也需要執行 PUSH
					</aside>
					vvvv

					### DVC Basics
					#### Step3: 推送檔案至遠端存放區 (DVC storage)
					1. 添加 remote storage 位址<br>
					`dvc remote add -d <remote_name> gs://bucket/remote`<br>

					2. 添加認證檔，才有權限存取 remote storage<br>
					`dvc remote modify <remote_name> credentialpath <credential_file>`

					3. 推送檔案至 remote storage<br>
					`dvc push <your_file.dvc>`

					<aside class="notes">
						與 git 十分類似，一樣先添加 remote<br>
						remote 如果是使用 cloud service，則需要額外追加認證檔
					</aside>
					vvvv

					### DVC Basics
					<img src="https://i.imgur.com/H7YaPk1.gif"/>
					<aside class="notes">
						設定 remote 相關資訊<br>
						若有認證檔，記得存放至專案目錄的相對應位置<br>
						dvc remote 設定相關資訊後，會直接寫入 `.dvc/config`，概念上也與 Git 十分相似<br>
						push 若有加檔名則針對該 `.dvc` 所連結到的檔案進行推送；<br>
						否則，會將所有 `.dvc` 所連結到的檔案全部推上去
					</aside>
					vvvv

					### DVC Basics
					#### Step3: 推送檔案至遠端存放區 (DVC storage)
					* [Google Drive](https://dvc.org/doc/user-guide/setup-google-drive-remote#url-format)
					* [AWS S3](https://medium.com/@shamnad.p.s/how-to-create-an-s3-bucket-and-aws-access-key-id-and-secret-access-key-for-accessing-it-5653b6e54337)
					* [GCP Cloud Storage](https://medium.com/@daniel820710/%E6%A9%9F%E5%99%A8%E5%AD%B8%E7%BF%92%E5%BE%9E%E9%9B%B6%E5%88%B0%E4%B8%80-day4-data-science-%E7%9A%84%E7%89%88%E6%8E%A7-dvc-%E7%9A%84%E5%BB%BA%E7%AB%8B%E8%88%87%E4%BD%BF%E7%94%A8-80b416268d5d)
					* [Azure](https://github.com/iterative/dvc/issues/2200)

					> 更多細節請參考[官網](https://dvc.org/doc/command-reference/remote/add)
					<aside class="notes">
						另外，還支援許多不同的 remote storage solution<br>
						以上功能，為 DVC 最基本的使用方式<br>
						easy?
					</aside>
					</script>
				</section>

				<section data-markdown data-background="https://media.altpress.com/uploads/2018/06/mind_blown_gif.gif">
					<script type="text/template">
						<h1 style="color:white; ">DVC in-depth</h1>
						<aside class="notes">
							接下來進行比較複雜的部份，實際將 DVC 導入 DS 專案中<br>
							若對 DS 整體流程仍不熟悉，建議可以回去複習一下<br>
							否則，稍後的內容可能真的會讓你 "mind exploding"
						</aside>
					</script>
				</section>

				<section data-background-image="pics/dsu_course_background.png" data-markdown data-separator=">>>>" data-separator-vertical="vvvv">
					<script type="text/template">
					### DVC in-depth
					## connect code & data & model, and more !
					<img src="https://i.imgur.com/59qts6C.png" width="700px"/><br>
					> 以 [kaggle](https://www.kaggle.com/yassineghouzam/introduction-to-cnn-keras-0-997-top-6/notebook) 範例為基礎，深入說明
					<aside class="notes">
						這個章節，將介紹如何在 data science 專案中，實際應用 DVC<br>
						包含data清理、擴增以及分割 ...等等<br>
						本範例參考自 KAGGLE，實作的細節請自行參閱
					</aside>
					vvvv

					### DVC in-depth
					#### Step1: 資料前處理<br>
					1. data & label 分離
					1. image data 進行 normalize
					1. data & label 進行 reshape
					1. 輸出檔案至指定目錄下
					<aside class="notes">
						normalize - 優化 training 流程<br>
						reshape - 為了符合後續 ML Model 之 input 格式
					</aside>
					vvvv

					### DVC in-depth
					#### Step1: 資料前處理
					```bash
					dvc run \
					-f ./dataset/preprocess.dvc \
					-d ./data_preprocess.py -d ./dataset/raw/ \
					-o ./dataset/preprocess/origin/ \
					python ./data_preprocess.py ./dataset/raw/train.csv ./dataset/raw/test.csv
					```
					<aside class="notes">
						為了將檔案與程式做連結，改採用 run 取代 add
						`-f` 指定 .dvc 輸出路徑<br>
						`-d` 為 dependency，此次作業參考的目錄(指定檔名)資訊<br>
						`-o` 為輸出檔案所參考的目錄(指定檔名)<br>
						最後則是要執行的指令&相關參數
					</aside>
					vvvv

					### DVC in-depth
					#### Step1: 資料前處理
					輸出之 .dvc 結構:
					```yaml
					md5: d9ecfdb186780bbabb032c7e7a87e7cc
					cmd: python .\data_preprocess.py .\dataset\raw\train.csv .\dataset\raw\test.csv
					wdir: ..
					deps:
					- md5: 2d4b690571d4120f8e16457af41cce91
					  path: data_preprocess.py
					- md5: 375153de2b0a04541999a9f54fa83d31.dir
					  path: dataset/raw
					outs:
					- md5: 8f4d8b7328f3d48873aab7cce1e281b1.dir
					  path: dataset/preprocess/origin
					  cache: true
					  metric: false
					  persist: false
					```
					<aside class="notes">
						包含python指令、input\output 檔案等資訊<br>
						DVC 也根據這些資訊，將 DS workflow 串聯起來<br>
						dvc run 與 dvc add 類似，執行完畢後記得要多加個 dvc push，將資料送至 remote<br>
						最後別忘了，也要將 .dvc 透過 git add\commit 進版管控
					</aside>
					vvvv

					### DVC in-depth
					#### Step2: 資料擴增<br>
					1. 讀取前個步驟處理過後之資料
					2. 引入 ImageDataGenerator 模組，並為其設定參數
					3. 將資料套用至 ImageDataGenerator，並輸出添加雜訊後的資料
					1. 輸出檔案至指定目錄下
					<aside class="notes">
						透過 python keras 套件提供之模組，對資料進行擴增<br>
						目的在於，透過添加 noise，提升 training set 之多樣性，進而提升訓練出來 model 的穩健性<br>
						也就是說，model 在遇到從沒看過的資料時，比較不會出現嚴重預測的偏差。<br>
						有興趣，可以跑範例 script，並把輸出的圖片畫出來看看，和原始檔進行比較
					</aside>
					vvvv

					### DVC in-depth
					#### Step2: 資料擴增<br>
					```bash
					dvc run \
					-f ./dataset/augment.dvc \
					-d ./data_augmentation.py -d ./dataset/preprocess/origin/ \
					-o ./dataset/augment/origin/ \
					python ./data_augmentation.py ./dataset/preprocess/origin/trainX_processed.npy ./dataset/preprocess/origin/trainY_processed.npy
					```
					<aside class="notes">
						動作與先前步驟相同，單純對 input\output\command 進行抽換
					</aside>
					vvvv

					### DVC in-depth
					#### Step2: 資料擴增<br>
					輸出之 .dvc 結構:
					```yaml
					md5: acde58c994c22f43748519e4e5005a7c
					cmd: python .\data_augmentation.py .\dataset\preprocess\origin\trainX_processed.npy
					  .\dataset\preprocess\origin\trainY_processed.npy
					wdir: ..
					deps:
					- md5: 01a7d1541755522641fddfe10580c46c
					  path: data_augmentation.py
					- md5: 8f4d8b7328f3d48873aab7cce1e281b1.dir
					  path: dataset/preprocess/origin
					outs:
					- md5: 46a4013554717c16c6993fd8be873851.dir
					  path: dataset/augment/origin
					  cache: true
					  metric: false
					  persist: false
					```
					<aside class="notes">
						輸出格式與前者相同
					</aside>
					vvvv

					### DVC in-depth
					#### Step3: 資料分割<br>
					1. 讀取前幾個步驟處理過後之資料
					2. 決定分割比例，並將資料以 random 的形式執行分割作業
					3. 輸出檔案至指定目錄下
					<aside class="notes">
						在訓練的過程中，除了 testing&training 外，通常會從 training 切出一小塊 validation<br>
						作為訓練 model 的過程中，驗證 performance 的參考依據
					</aside>
					vvvv

					### DVC in-depth
					#### Step3: 資料分割<br>
					```bash
					dvc run
					-f ./dataset/split_aug.dvc \
					-d ./data_split.py -d ./dataset/augment/origin \
					-o ./dataset/augment/split \
					python ./data_split.py ./dataset/augment/origin/trainX_aug.npy ./dataset/augment/origin/trainY_aug.npy
					```
					<aside class="notes">
						同上
					</aside>
					vvvv

					### DVC in-depth
					#### Step3: 資料分割<br>
					輸出之 .dvc 結構:
					```yaml
					md5: b662f168767e7eb0b895c02396e6f020
					cmd: python .\data_split.py .\dataset\augment\origin\trainX_aug.npy .\dataset\augment\origin\trainY_aug.npy
					wdir: ..
					deps:
					- md5: 517f08c1d146b21178dc9b0859d91aad
					  path: data_split.py
					- md5: 46a4013554717c16c6993fd8be873851.dir
					  path: dataset/augment/origin
					outs:
					- md5: a9a6e50e394bc2fd222b49f2156a53f6.dir
					  path: dataset/augment/split
					  cache: true
					  metric: false
					  persist: false
					```
					<aside class="notes">
						大同小異<br>
						DS 專案，data pipeline 相關前處理作業到此結束。<br>
						接下來進入訓練&驗證流程
					</aside>
					vvvv

					### DVC in-depth
					<img src="https://i.imgur.com/n0iUDMD.png" width="700px"/><br>
					以 [kaggle](https://www.kaggle.com/yassineghouzam/introduction-to-cnn-keras-0-997-top-6/notebook) 範例為基礎，深入說明
					<aside class="notes">
						以 training set 進行模型訓練；<br>
						再利用 validation set 進行模型 PERFORMANCE 的驗證
					</aside>
					vvvv

					### DVC in-depth
					#### Step4: 影像辨識模型訓練
					<img src="https://miro.medium.com/max/3288/1*uAeANQIOQPqWZnnuH-VEyw.jpeg" width="700px"/><br>
					> 詳細介紹可參考 [這裡](https://medium.com/jameslearningnote/%E8%B3%87%E6%96%99%E5%88%86%E6%9E%90-%E6%A9%9F%E5%99%A8%E5%AD%B8%E7%BF%92-%E7%AC%AC5-1%E8%AC%9B-%E5%8D%B7%E7%A9%8D%E7%A5%9E%E7%B6%93%E7%B6%B2%E7%B5%A1%E4%BB%8B%E7%B4%B9-convolutional-neural-network-4f8249d65d4f)
					<aside class="notes">
						範例使用的是當前影像處理最主流的 CNN model<br>
						前幾堂課所提到的 NN model 之其中一種變型
					</aside>
					vvvv

					### DVC in-depth
					#### Step4: 影像辨識模型訓練<br>
					1. 讀取處理過後之資料
					3. 定義 model structure，並帶入對應參數
					4. 執行 training 作業，並帶入對應參數
					3. 輸出檔案至指定目錄下

					<aside class="notes">
						先設計模型架構，再建立訓練流程<br>
						記得設定相關參數，主要是 training optimizor \ process 這兩項 (batch\epoch etc.)
					</aside>
					vvvv

					### DVC in-depth
					#### Step4: 影像辨識模型訓練<br>
					```bash
					dvc run
					-f ./model/train.dvc \
					-p optimizer,train \
					-d ./train.py -d ./dataset/augment/split/ \
					-o ./model/model.h5
					python ./train.py ./dataset/augment/split/trainX_aug.npy ./dataset/augment/split/trainY_aug.npy
					```

					`params.yaml (DVC 預設名稱)`
					<aside class="notes">
						`-p` 將讀取 `params.yaml`檔中，本次作業所使用到之參數，並進行標記<br>
						以利於後續追蹤\管控
					</aside>
					vvvv

					### DVC in-depth
					#### Step4: 影像辨識模型訓練<br>
					輸出之 .dvc 結構:
					```yaml
					md5: b980047ec6fc7ce8e3402b74541fd1fa
					cmd: python .\train.py .\dataset\augment\split\trainX_aug.npy .\dataset\augment\split\trainY_aug.npy
					wdir: ..
					deps:
					- md5: dd08ed6268819c759bd40912e2d71238
					  path: train.py
					- md5: a9a6e50e394bc2fd222b49f2156a53f6.dir
					  path: dataset/augment/split
					- path: params.yaml
					  params:
					    optimizer:
					      lr: 0.001
					    train:
					      epochs: 1
					      batch_size: 86
					outs:
					- md5: 872267a7a627b6994953e2440d08e072
					  path: model/model.h5
					  cache: true
					  metric: false
					  persist: false
					```
					<aside class="notes">
						可以發現，相較於前面幾個步驟，這裡多了些 params 相關資訊<br>
						指令帶入資訊越多，.dvc 保存越多資訊。<br>
						協作者要開發時，也會更加輕鬆
					</aside>
					vvvv

					### DVC in-depth
					#### Step5: 模型效能評估<br>
					1. 讀取處理過後之資料 & model
					2. 利用 model 對資料進行預測
					3. 計算 evaluation metrics
					4. 輸出檔案至指定目錄下
					<aside class="notes">
						使用先前分割的 validation 進行 performance 驗證<br>
						目的: 利用在 training 過程中 model 從未見過的資料，實際去做預測<br>
						如此才能夠得到更客觀的量測值。
					</aside>
					vvvv

					### DVC in-depth
					#### Step5: 模型效能評估<br>
					```bash
					dvc run
					-f ./model/evaluate.dvc \
					-d ./evaluate.py -d ./dataset/preprocess/split/ -d ./model/model.h5 \
					-m ./model/model_evl.metric \
					python ./evaluate.py ./model/model.h5 ./dataset/preprocess/split/valX_processed.npy ./dataset/preprocess/split/valY_processed.npy
					```

					`XXX.metric` (DVC 預設讀取格式)
					<aside class="notes">
					`-m` 表示將 model performance 之相關 metrics，輸出至 `XXX.metric` 檔<br>
					只要附檔名正確，DVC 都抓得到檔案
					</aside>
					vvvv

					### DVC in-depth
					#### Step5: 模型效能評估<br>
					輸出之 .dvc 結構如下:
					```yaml
					md5: a3f40081fd658a3e8c872caabcea9cd8
					cmd: python .\evaluate.py .\model\model.h5 .\dataset\preprocess\split\valX_processed.npy
					  .\dataset\preprocess\split\valY_processed.npy
					wdir: ..
					deps:
					- md5: 39d30c72b59d13dc023d5b987fcac452
					  path: evaluate.py
					- md5: 01e402f17802858bd52482bcf8b038bd.dir
					  path: dataset/preprocess/split
					- md5: 872267a7a627b6994953e2440d08e072
					  path: model/model.h5
					outs:
					- md5: e552c20a2aff93ff4920a0e9e8c44315
					  path: model/model_evl.metric
					  cache: true
					  metric: true
					  persist: false
					```
					<aside class="notes">
					格式上與前幾個步驟相似，只差在 `outs` 項目被設定為 `metric: true`<br>
					到這邊，data science 專案中，所有的基本作業流程，已建立完畢<br>
					但是...，還沒結束
					</aside>
					vvvv

					# DVC in-depth
					![](https://i.gifer.com/7Fj4.gif)
					<aside class="notes">
					希望各位還頂得住，放張圖讓大家緩衝一下<br>
					接下來才要進入重頭戲，介紹 DVC 的主打功能
					</aside>
					vvvv

					### DVC in-depth
					#### Step6: 視覺化呈現<br>
					建立 2 個訓練模型，分別用 git tag 加上標籤
					![](https://i.imgur.com/BDCJhNe.png)
					<aside class="notes">
						除了上述流程建立的 model 外，本次課程也提供不使用 data augmentation 所建立的模型<br>
						首先展示 git 當前的狀態，分別為兩個 model 打上不同 tag
					</aside>
					vvvv

					### DVC in-depth
					#### Step6: 視覺化呈現<br>
					` dvc pipeline show  --ascii .\model\evaluate.dvc`<br>
					<img src="https://i.imgur.com/vCh2fCz.png" width="400px"/>
					<aside class="notes">
						由於前面一連串的步驟，input、output 都有對應到<br>
						因此可以使用 `dvc pipeline` 來查看自己所建立的流程<br>
						從前處理、分割、擴增、訓練 到 驗證，一目了然
					</aside>
					vvvv

					### DVC in-depth
					#### Step6: 視覺化呈現<br>
					Git 切換至 `tag: baseline-update` <br>
					![](https://i.imgur.com/Pu4jbWh.png)<br>
					DVC 切換檔案<br>
					![](https://i.imgur.com/JPtzgcN.png)
					<aside class="notes">
						接著切換至 "未使用 data augmentation" 之模型<br>
						記得要把 DVC 所控管的檔案，同步進行切換
					</aside>
					vvvv

					### DVC in-depth
					#### Step6: 視覺化呈現<br>
					` dvc pipeline show  --ascii .\model\evaluate.dvc`<br>
					<img src="https://i.imgur.com/vusMh6C.png" width="400px"/>
					<aside class="notes">
						pipeline 與前者有些許不同，workflow 相對簡單<br>
					</aside>
					vvvv

					### DVC in-depth
					#### Step6: 視覺化呈現<br>
					`dvc metric show`<br>
					<img src="https://i.imgur.com/7GcxXMO.png" width="400px"/>
					<aside class="notes">
						因為 evaluation 階段有輸出 metrics，所以能透過 dvc metric 查看紀錄。<br>
						這裡只針對 git 有打上 tag 的 commit 進行呈現
					</aside>
					vvvv

					### DVC in-depth
					#### Step7: 多人協作<br>
					* Project owner<br>
						`git push --tags`、 `dvc push`
					* Collaborators<br>
						`git clone`、 `dvc pull`、 `dvc repro`
					<aside class="notes">
						最後，來到最重要，多人協同開發的部分<br>
						原作者先 push，協作者透過 clone\pull\repro 在本地重現一次原始流程
					</aside>
					vvvv

					### DVC in-depth
					#### Step7: 多人協作<br>
					<img src="https://i.imgur.com/55CyFWx.png" width="700px"/>
					<aside class="notes">
						git clone 獲取 code 以及 DVC 相關檔案<br>
						dvc pull 將各階段 pipeline 的 dependency 從 remote 拉下來(若使用 cloud service 記得先將認證檔放置對應路徑)<br>
						PS. 專案初始化，從 remote 下載檔案到 .dvc/cache/ 需要花不少時間<br>
						以截圖代替
					</aside>
					vvvv

					### DVC in-depth
					#### Step7: 多人協作<br>
					<img src="https://i.imgur.com/RKELnsp.png" width="700px"/>
					<aside class="notes">
						所有檔案都準備妥當後，直接 dvc repro<br>
						就會照著先前 dvc pipeline show 所畫出來的流程執行工作<br>
						以上，就是一整套 DS 專案協作流程的導覽
					</aside>
					</script>
				</section>

				<section data-markdown data-separator=">>>>" data-separator-vertical="vvvv">
					<script type="text/template">
						# Kindly Reminder
						* 投影片內容已整理成 [筆記](https://hackmd.io/@vhqEisKDQKSPCplQaKZRSw/B1BnZeCiL)
						* 解說細節可參閱 [投影片](https://dsucourse.imfast.io/)
						* 投影片中使用之素材: [原始碼1](https://github.com/https-github-com-DSU/DSU_Course_VC) 、 [原始碼2](https://github.com/https-github-com-DSU/git_test)
						<aside class="notes">
							投影片整理成文字稿<br>
							附上投影片連結<br>
							課程中參考之程式，也一併附上連結
						</aside>
						>>>>

						## More resources ...
						<style>
					    	#myFrame { width:1000px; height:500px; }
						</style>
						<iframe id="myFrame" src="https://dvc.org/doc/tutorials"></iframe>
						<aside class="notes">
							若覺得投影片的說明不夠完整<br>
							參考 官方教學資源
						</aside>
						vvvv

						## More resources ...
						<style>
					    	#myFrame { width:1000px; height:500px; }
						</style>
						<iframe id="myFrame" src="https://katacoda.com/dvc"></iframe>
						<aside class="notes">
							或是，其他教學資源<br>
							總結一下今天的課程:<br>
							一開始說明 drawbacks of git 。其中，大型檔案最令人困擾<br>
							過去的解決方案也有其侷限性，再加上 DS 的發展，已不敷使用<br>
							於是引入 solution - DVC，從安裝到基本操作，<br>
							並實際導入 DS 專案跑一次流程，展現 DVC 之優勢
						</aside>
					</script>
				</section>

				<section data-markdown data-background="https://media.giphy.com/media/VHrFbmOtBwysbsYnka/giphy.gif">
					<script type="text/template">
					<aside class="notes">
						以上是對於 code&data&model 版本控制 solution 的介紹<br>
						若有疑問，歡迎在頻道\筆記中留言
					</aside>
					</script>
				</section>

			</div>
		</div>

		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				hash: true,
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/highlight/highlight.js' },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});
		</script>
	</body>
</html>
